# Auto Secret Operator

[![Artifact Hub](https://img.shields.io/endpoint?url=https://artifacthub.io/badge/repository/auto-secret-operator)](https://artifacthub.io/packages/helm/auto-secret-operator/auto-secret-operator)

Kubernetes operator that automatically generates secrets with passwords, database credentials, and GUIDs.

## Installation

### Using Helm from Artifact Hub (Easiest)

```bash
# Add the Helm repository
helm repo add auto-secret-operator https://sindrema.github.io/auto-secret-operator
helm repo update

# Install the operator
helm install auto-secret-operator auto-secret-operator/auto-secret-operator
```

### Using Helm from source

```bash
# Setup Helm chart (first time only)
./setup-helm-chart.ps1

# Install with Helm
helm install auto-secret-operator ./helm/auto-secret-operator
```

See [HELM-INSTALL.md](HELM-INSTALL.md) for detailed Helm installation options.

### Using kubectl

```bash
./deploy.sh
```

## Usage

### AutoSecretBasic - Generate username/password secrets

**Input:**
```yaml
apiVersion: auto-secret.io/v1alpha1
kind: AutoSecretBasic
metadata:
  name: custom-myapp-user
  namespace: mynamespace
spec:
  username: myapp-random-user
```

**Output:** Secret `custom-myapp-user` (type: BasicAuth)
```yaml
data:
  password: <auto-generated>
  username: myapp-random-user
```

### AutoSecretDb - Generate database connection secrets

**Input:**
```yaml
apiVersion: auto-secret.io/v1alpha1
kind: AutoSecretDb
metadata:
  name: myapp-db-readonly
  namespace: mynamespace
spec:
  username: myapp-db-user
  dbname: myapp_db
  dbhost: postgres-cluster.svc.cluster.local
```

**Output:** Secret `myapp-db-readonly` (type: BasicAuth)
```yaml
data:
  dbname: myapp_db
  fqdn-jdbc-uri: jdbc:postgresql://postgres-cluster.svc.cluster.local:5432/myapp_db?password=PASSWORD&user=myapp-db-user
  fqdn-uri: postgresql://myapp-db-user:PASSWORD@postgres-cluster.svc.cluster.local:5432/myapp_db
  host: postgres-cluster
  jdbc-uri: jdbc:postgresql://postgres-cluster.svc.cluster.local:5432/myapp_db?password=PASSWORD&user=myapp-db-user
  password: <auto-generated>
  pgpass: postgres-cluster:5432:myapp_db:myapp-db-user:PASSWORD
  port: "5432"
  uri: postgresql://myapp-db-user:PASSWORD@postgres-cluster.svc.cluster.local:5432/myapp_db
  user: myapp-db-user
  username: myapp-db-user
```

### AutoSecretGuid - Generate GUID secrets

**Input:**
```yaml
apiVersion: auto-secret.io/v1alpha1
kind: AutoSecretGuid
metadata:
  name: custom-guid-secret
  namespace: mynamespace
spec:
  format: uuidv4  # optional: uuidv4, uuidv7, short-uuid
```

**Output:** Secret `custom-guid-secret` (type: Opaque)
```yaml
data:
  guid: 123e4567-e89b-12d3-a456-426614174000
```

## Examples

See `AutoSecrets/` directory for complete input/output examples.
